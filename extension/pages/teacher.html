<!doctype html>
<html lang="en" data-theme="system">
<head>
  <meta charset="utf-8" />
  <title>C.L.A.R.A. — Teacher</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <link rel="stylesheet" href="../styles.css" />
  <script src="../theme.js"></script>
</head>
<body>
  <main class="page">
    <div class="card">
      <div class="card-title">
        <span>Class Portfolio</span>
      </div>

      <div class="row wrap" style="gap:8px; align-items:center">
        <input type="file" id="files" multiple accept="application/json" />
        <button id="btnCSV" class="btn" disabled>Export Class CSV</button>
        <button id="btnJSON" class="btn" disabled>Export Aggregate JSON</button>
        <button id="btnPNG" class="btn primary" disabled>Export Class Report (PNG)</button>
        <button id="btnCopyPNG" class="btn ghost" disabled>Copy PNG</button>
        <button id="btnSample" class="btn ghost" type="button">Load Sample</button>
        <button id="btnClear" class="btn ghost" type="button" disabled>Clear</button>
        <span class="spacer"></span>
        <span class="badge">v0.1 JSON</span>
        <span class="badge ghost">Local‑only</span>
      </div>
    </div>

    <div class="card">
      <div class="dropzone" id="drop">Drop portfolio JSON files here, or use “Choose files”.</div>
    </div>

    <!-- NEW: Overview card with stats + charts -->
    <div class="card">
      <div class="card-title">
        <span>Class overview</span>
      </div>

      <div class="stats stats-compact" style="margin-bottom:8px">
        <div class="stat num-center">
          <div class="stat-num" id="stCount">0</div>
          <div class="stat-label">Students</div>
        </div>
        <div class="stat num-center">
          <div class="stat-num" id="stTotalMin">0</div>
          <div class="stat-label">Total minutes</div>
        </div>
        <div class="stat num-center">
          <div class="stat-num" id="stAvgMin">0</div>
          <div class="stat-label">Avg minutes</div>
        </div>
        <div class="stat num-center">
          <div class="stat-num" id="stMedianScore">—</div>
          <div class="stat-label">Median score</div>
        </div>
        <div class="stat num-center">
          <div class="stat-num" id="stAvgScore">0</div>
          <div class="stat-label">Avg score</div>
        </div>
      </div>

      <div class="tile-title">Minutes per student (top 10)</div>
      <div class="chart"><canvas id="tMinutes" class="theme-surface" style="width:100%;height:220px"></canvas></div>

      <div class="tile-title" style="margin-top:12px">Score distribution</div>
      <div class="chart"><canvas id="tScores" class="theme-surface" style="width:100%;height:180px"></canvas></div>

      <div class="tile-title" style="margin-top:12px">Top tools (count)</div>
      <div class="chart"><canvas id="tTools" class="theme-surface" style="width:100%;height:180px"></canvas></div>
    </div>

    <div class="card">
      <div class="card-title">
        <span>Students</span>
        <div class="row" style="gap:8px">
          <input id="search" placeholder="Filter by alias" />
          <button id="clearSearch" class="btn ghost">Clear</button>
        </div>
      </div>

      <table id="tbl" class="table">
        <thead>
          <tr>
            <th data-k="alias">Alias</th>
            <th data-k="score">Score</th>
            <th data-k="minutes">Minutes</th>
            <th data-k="top">Top tool</th>
            <th data-k="streak">Streak</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <div id="emptyMsg" class="muted" style="display:none;margin-top:8px">No students loaded.</div>
      <div class="row" style="margin-top:12px; gap:8px">
        <div>
          Summary: <span id="sCount">0</span> students •
          Median: <span id="sMedian">—</span> •
          Avg minutes: <span id="sAvgMin">—</span> •
          Top tools: <span id="sTopTools">—</span>
        </div>
      </div>
    </div>
  </main>

  <footer class="footer small muted">C.L.A.R.A. · Teacher page</footer>

  <script src="teacher.js"></script>
</body>
</html>